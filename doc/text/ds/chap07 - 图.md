### 拓展：树的计数问题

这一节开始，讨论树的计数问题：<u>求规模为n的有根带标号树的数量。</u>

下面分析这个问题。首先，最朴素的想法仍然是列出递归方程求解，就像在计算出栈序列数量的时候那样。但是，由于引入了标号，情况会变得非常复杂。

> 设规模为n的树有$f(n)$棵。递归边界为$f(0)=f(1)=1$。
>
> 首先，取一个节点作为根，有n种选取方式。
>
> 其次，对于剩下的n-1个节点，有可能会形成树根的1到n-1棵子树。设子树的数量为k。
>
> 第三，设第$i$棵子树的规模为$n_i$，那么$\sum n_i =n-1$。同时，这第$i$​​棵子树的构造方法有$f(n_i)$种。
>
> 第四，最为麻烦的问题是，把根之外的n-1个带标号的节点，分给k个子树的方法，这是个多重组合数。

这样得到的递归方程是：
$$
f(n)=n\sum_{k=1}^{n-1}\sum_{n_1+n_2+\dots+n_k =n-1}{n-1\choose n_1,n_2,\dots,n_{k}}\prod_{i=1}^k f(n_i)
$$
相对于出栈序列数量的那个递归方程，这个递归方程显得过于复杂了。求解它超出了笔者的能力范围，因此笔者在下一小节，将介绍解决问题的另一个路径。

### 拓展：Prufer序列

除了列出递归方程求解之外，之前笔者还介绍过另一个求解计数问题的路径：**构造一一映射**。

> 之前有两次用到一一映射的思想。
>
> 1. 在讨论向量置乱问题的时候，将全排列映射到一个n元组，以探讨如何构造随机置乱算法。
> 2. 在讨论合法括号序列的时候，通过将合法括号序列映射到出栈序列，从而直接利用Catalan数的通项公式。

为了对树的数量进行统计，这里希望将树映射到一个序列上来，从而将**半线性结构线性化**，从而回避掉因为子树分支产生的复杂讨论。

> 构造一一映射的目的，是为了让不方便计数的对象，变换成容易计数的对象。因此，在构造这个一一映射的时候，就应该有的放矢，<u>针对原问题中计数的困难点，尽可能让变换后的对象回避掉这些困难点</u>。

树的定义是递归的；目标序列的定义，也应该是递归的。于是最重要的问题是，如何选取序列的第一个元素——因为在递归定义的序列中，只要选取了第一个元素，后面的元素就可以递归地选取下去。

一般地，序列的第一个元素有三种选取的思路：

1. 从上到下地选取。这种情况下，一般第一个元素取为树根。

   > 第一个元素取为树根的情况下，又会遇到上一小节遇到的问题：不能确定树根的子树数量。只要树根有至少两棵子树，那么递归定义的序列，在不添加额外的分隔符的情况下，就没有办法区分两棵子树的边界。
   >
   > 因此，这种做法在计数问题上走不通。

2. 从下到上地选取。这种情况下，一般第一个元素取为叶子。

   > 因为非平凡树至少有两个叶子节点，所以必须要对选取的叶子作出规定，比如，选取“最左边的叶子”。
   >
   > 

3. 从中间选取。显然这不合理。







